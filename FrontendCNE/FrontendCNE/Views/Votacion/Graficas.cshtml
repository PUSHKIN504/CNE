
@{
    ViewData["Title"] = "Graficas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Graficas</h1>
<header class="w-100 d-flex justify-content-between align-items-center p-2 text-center" style="background: rgb(255,255,255); min-height: 12vh;">
    <h1>Conteo de Votos</h1>
    <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Votar</a>
</header>

<div class="row">
    <div class="col-lg-6">
        <div class="card">

            <div class="card-body">
                <h5 class="card-title">Presidentes</h5>
                <div id="pieChartAlcaldes"></div>
                <canvas id="myChart"></canvas>
                <script>
                    //document.addEventListener("DOMContentLoaded", () => {
                        
                        // Hacer un fetch para obtener los datos de la API
                        //fetch('https://localhost:44377/Presidentes/List')
                        //    .then(response => response.json())
                        //    .then(data => {
                        //        // Los datos deben estar en un formato adecuado para ApexCharts
                        //        // Aquí se asume que data tiene la estructura adecuada,
                        //        // puedes ajustar esto según la respuesta real de tu API

                        //        const seriesData = data.pre_Votos;
                        //        const labelsData = data.labels;
                        //        new Chart(seriesData, {s
                        //            type: 'bar',
                        //            data: {
                        //                labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                        //                datasets: [{
                        //                    label: '# of Votes',
                        //                    data: data.pre_Votos,
                        //                    borderWidth: 1
                        //                }]
                        //            },
                        //            options: {
                        //                scales: {
                        //                    y: {
                        //                        beginAtZero: true
                        //                    }
                        //                }
                        //            }
                        //        });
                        //        // Crear y renderizar la gráfica con los datos obtenidos
                        //        //new Chart(document.querySelector("#pieChartAlcaldes"), {
                        //        //    series: seriesData,
                        //        //    chart: {
                        //        //        height: 350,
                        //        //        type: 'pie',
                        //        //        toolbar: {
                        //        //            show: true
                        //        //        }
                        //        //    },
                        //        //    labels: labelsData
                        //        //}).render();
                        //    })
                        //    .catch(error => {
                        //        console.error('Error al obtener los datos:', error);
                        //    });
                    //});
                </script>
            </div>


            <div class="card-body">

                <h5 class="card-title">Alcaldes</h5>
                <div id="pieChartAlcaldes"></div>




                @*<script>
                    document.addEventListener("DOMContentLoaded", () => {


                        new ApexCharts(document.querySelector("#pieChartAlcaldes"), {
                            series: seriesData,
                            chart: {
                                height: 350,
                                type: 'pie',
                                toolbar: {
                                    show: true
                                }
                            },
                            labels: labelsData
                        }).render();
                    });
                </script>*@

            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Presidentes</h5>
                <div id="pieChartPresidentes"></div>

                @*<script>
                    document.addEventListener("DOMContentLoaded", () => {


                        new ApexCharts(document.querySelector("#pieChartPresidentes"), {
                            series: seriesData,
                            chart: {
                                height: 350,
                                type: 'pie',
                                toolbar: {
                                    show: true
                                }
                            },
                            labels: labelsData
                        }).render();
                    });
                </script>*@

            </div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!--<script src="~/vendors/js/vendor.bundle.base.js"></script>-->
<!-- endinject -->
<!-- Plugin js for this page-->
<!-- End plugin js for this page-->
<!-- inject:js -->
<!--<script src="~/js/off-canvas.js"></script>
<script src="~/js/hoverable-collapse.js"></script>
<script src="~/js/template.js"></script>
<script src="~/js/settings.js"></script>
<script src="~/js/todolist.js"></script>-->
<script src="~/lib/jquery/dist/jquery.js"></script>
<script>
    var Votos = [], presidentes = [];


    $(document).ready(function () {
        var url = "https://localhost:44377/Presidentes/List";

        fetch(url)
            .then(function (result) {
                if (result.ok) {
                    return result.json();
                }
            })
            .then(function (data) {

                console.log(data)

                data.data.forEach(function(row) {
                 
                    presidentes.push(row.per_Nombre);
                    Votos.push(row.pre_Votos);
                });

                   
                
                console.log('presi : ' + presidentes);
                console.log('presivot : ' + Votos);



            })
            .catch(error => console.log('Authorization failed : ' + error.message));

        const ctx = document.getElementById('myChart');
                const data = {
                    labels: presidentes,
                    datasets: [{
                        label: 'Presidentes',
                        data: Votos,
                        backgroundColor: [
                            'rgb(0, 121, 181)',
                            'rgb(54, 162, 235)',
                            'rgb(255, 205, 86)'
                        ],
                        hoverOffset: 4
                    }]
                };
                new Chart(ctx, {
                    type: 'doughnut',
                    data
                    //: {
                    //    labels: presidentes,
                    //    datasets: [{
                    //        label: '# of Votes',
                    //        data: Votos,
                    //        borderWidth: 1
                    //    }]
                    //}
                    //,
                    //options: {
                    //    scales: {
                    //        y: {
                    //            beginAtZero: true
                    //        }
                    //    }
                    //}
                });
    });
                
</script>